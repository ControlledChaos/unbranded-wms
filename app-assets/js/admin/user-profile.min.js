(function(e){function s(){"function"==typeof zxcvbn?(c.val()?(o(),r()):(c.val(c.data("pw")),c.trigger("pwupdate"),r()),1!==parseInt(m.data("start-masked"),10)?d.addClass("show-password"):m.trigger("click"),e("#password-weak-text-label").html(userProfileL10n.warnWeak)):setTimeout(s,50)}function a(){b=c.val(),d=c.parent(),p=e('<input type="text"/>').attr({id:"pass1-text",name:"pass1-text",autocomplete:"off"}).addClass(c[0].className).data("pw",c.data("pw")).val(c.val()).on(k,function(){p.val()!==b&&(h.val(p.val()),c.val(p.val()).trigger("pwupdate"),b=p.val())}),c.after(p),1===parseInt(c.data("reveal"),10)&&s(),c.on(k+" pwupdate",function(){c.val()!==b&&(b=c.val(),p.val()!==b&&p.val(b),c.add(p).removeClass("short bad good strong"),r())})}function t(){m.data("toggle",0).attr({"aria-label":userProfileL10n.ariaHide}).find(".text").text(userProfileL10n.hide).end().find(".dashicons").removeClass("dashicons-visibility").addClass("dashicons-hidden"),p.focus(),u.attr("for","pass1-text")}function n(){m=l.find(".wp-hide-pw"),m.show().on("click",function(){1===parseInt(m.data("toggle"),10)?(d.addClass("show-password"),t(),_.isUndefined(p[0].setSelectionRange)||p[0].setSelectionRange(0,100)):(d.removeClass("show-password"),m.data("toggle",1).attr({"aria-label":userProfileL10n.ariaShow}).find(".text").text(userProfileL10n.show).end().find(".dashicons").removeClass("dashicons-hidden").addClass("dashicons-visibility"),c.focus(),u.attr("for","pass1"),_.isUndefined(c[0].setSelectionRange)||c[0].setSelectionRange(0,100))})}function i(){var i,o,r;l=e(".user-pass1-wrap"),u=l.find("th label").attr("for","pass1-text"),e(".user-pass2-wrap").hide(),g=e("#submit, #wp-submit").on("click",function(){y=!1}),w=g.add(" #createusersub"),f=e(".password-weak"),v=f.find(".pw-checkbox"),v.change(function(){w.prop("disabled",!v.prop("checked"))}),c=e("#pass1"),c.length&&a(),h=e("#pass2").on(k,function(){h.val().length>0&&(c.val(h.val()),h.val(""),b="",c.trigger("pwupdate"))}),c.is(":hidden")&&(c.prop("disabled",!0),h.prop("disabled",!0),p.prop("disabled",!0)),i=l.find(".wp-pwd"),o=l.find("button.wp-generate-pw"),n(),o.length&&i.hide(),o.show(),o.on("click",function(){y=!0,o.hide(),i.show(),c.attr("disabled",!1),h.attr("disabled",!1),p.attr("disabled",!1),0===p.val().length&&s(),_.defer(function(){p.focus(),_.isUndefined(p[0].setSelectionRange)||p[0].setSelectionRange(0,100)},0)}),r=l.find("button.wp-cancel-pw"),r.on("click",function(){y=!1,p.val(""),wp.ajax.post("generate-password").done(function(e){c.data("pw",e)}),o.show(),i.hide(),f.hide(0,function(){v.removeProp("checked")}),c.prop("disabled",!0),h.prop("disabled",!0),p.prop("disabled",!0),t(),l.closest("form").is("#your-profile")&&(c.val("").trigger("pwupdate"),w.prop("disabled",!1))}),l.closest("form").on("submit",function(){y=!1,c.prop("disabled",!1),h.prop("disabled",!1),h.val(c.val()),d.removeClass("show-password")})}function o(){var s,a=e("#pass1").val();if(e("#pass-strength-result").removeClass("short bad good strong"),a)switch(s=wp.passwordStrength.meter(a,wp.passwordStrength.userInputBlacklist(),a),s){case-1:e("#pass-strength-result").addClass("bad").html(pwsL10n.unknown);break;case 2:e("#pass-strength-result").addClass("bad").html(pwsL10n.bad);break;case 3:e("#pass-strength-result").addClass("good").html(pwsL10n.good);break;case 4:e("#pass-strength-result").addClass("strong").html(pwsL10n.strong);break;case 5:e("#pass-strength-result").addClass("short").html(pwsL10n.mismatch);break;default:e("#pass-strength-result").addClass("short").html(pwsL10n.short)}else e("#pass-strength-result").html("&nbsp;")}function r(){var s=e("#pass-strength-result")[0];s.className&&(c.add(p).addClass(s.className),e(s).is(".short, .bad")?(v.prop("checked")||w.prop("disabled",!0),f.css("display","table-row")):(w.prop("disabled",!1),f.css("display","none")))}var l,d,c,p,u,h,f,v,m,w,g,b,k,y=!1;k="oninput"in document.createElement("input")?"input":"keyup",e(document).ready(function(){var s,a,t,n,r=e("#display_name"),l=r.val(),d=e("#user-toolbar-my-account").find(".display-name");e("#pass1").val("").on(k+" pwupdate",o),e("#pass-strength-result").show(),e(".color-palette").click(function(){e(this).siblings('input[name="admin_color"]').prop("checked",!0)}),r.length&&(e("#first_name, #last_name, #nickname").bind("blur.user_profile",function(){var s=[],a={display_nickname:e("#nickname").val()||"",display_username:e("#user_login").val()||"",display_firstname:e("#first_name").val()||"",display_lastname:e("#last_name").val()||""};a.display_firstname&&a.display_lastname&&(a.display_firstlast=a.display_firstname+" "+a.display_lastname,a.display_lastfirst=a.display_lastname+" "+a.display_firstname),e.each(e("option",r),function(e,a){s.push(a.value)}),e.each(a,function(t,n){if(n){var i=n.replace(/<\/?[a-z][^>]*>/gi,"");a[t].length&&-1===e.inArray(i,s)&&(s.push(i),e("<option />",{text:i}).appendTo(r))}})}),r.on("change",function(){if(t===n){var s=e.trim(this.value)||l;d.text(s)}})),s=e("#color-picker"),a=e("#colors-css"),t=e("input#user_id").val(),n=e('input[name="checkuser_id"]').val(),s.on("click.colorpicker",".color-option",function(){var s,i=e(this);if(!i.hasClass("selected")&&(i.siblings(".selected").removeClass("selected"),i.addClass("selected").find('input[type="radio"]').prop("checked",!0),t===n)){if(0===a.length&&(a=e('<link rel="stylesheet" />').appendTo("head")),a.attr("href",i.children(".css_url").val()),"undefined"!=typeof wp&&wp.svgPainter){try{s=e.parseJSON(i.children(".icon_colors").val())}catch(e){}s&&(wp.svgPainter.setColors(s),wp.svgPainter.paint())}e.post(ajaxurl,{action:"save-user-color-scheme",color_scheme:i.children('input[name="admin_color"]').val(),nonce:e("#color-nonce").val()}).done(function(s){s.success&&e("body").removeClass(s.data.previousScheme).addClass(s.data.currentScheme)})}}),$codepicker=e("#code-theme-picker"),a=e("#theme-css"),t=e("input#user_id").val(),n=e('input[name="checkuser_id"]').val(),$codepicker.on("click.codepicker",".code-theme-option",function(){var s,i=e(this);if(!i.hasClass("selected")&&(i.siblings(".selected").removeClass("selected"),i.addClass("selected").find('input[type="radio"]').prop("checked",!0),t===n)){if(0===a.length&&(a=e('<link rel="stylesheet" />').appendTo("head")),a.attr("href",i.children(".css_url").val()),"undefined"!=typeof wp&&wp.svgPainter){try{s=e.parseJSON(i.children(".icon_colors").val())}catch(e){}s&&(wp.svgPainter.setColors(s),wp.svgPainter.paint())}e.post(ajaxurl,{action:"save-user-code-theme",code_theme:i.children('input[name="code_theme"]').val(),nonce:e("#code-theme-nonce").val()}).done(function(s){s.success&&e("body").removeClass(s.data.previousCodeTheme).addClass(s.data.currentCodeTheme)})}}),i()}),e("#destroy-sessions").on("click",function(s){var a=e(this);wp.ajax.post("destroy-sessions",{nonce:e("#_wpnonce").val(),user_id:e("#user_id").val()}).done(function(e){a.prop("disabled",!0),a.siblings(".notice").remove(),a.before('<div class="notice notice-success inline"><p>'+e.message+"</p></div>")}).fail(function(e){a.siblings(".notice").remove(),a.before('<div class="notice notice-error inline"><p>'+e.message+"</p></div>")}),s.preventDefault()}),window.generatePassword=s,e(window).on("beforeunload",function(){if(!0===y)return userProfileL10n.warn})})(jQuery);